# Google Map Exporter 使い方ガイド

Google Maps から店舗情報を検索し、CSVファイルに出力するツールです。

---

## 動作環境

- **Windows 10/11**
- **Node.js 18以上** （https://nodejs.org/ からダウンロード）

---

## 初期セットアップ（初回のみ）

### 方法1: バッチファイルを使う（推奨）

1. **`セットアップ.bat`** をダブルクリック
2. セットアップが完了するまで待つ（数分かかります）
3. 「セットアップ完了！」と表示されたら完了

### 方法2: コマンドラインを使う

```bash
npm install
```

> 自動的にChromiumブラウザもインストールされます

---

## 起動方法

### 方法1: バッチファイルを使う（推奨）

1. **`起動.bat`** をダブルクリック
2. **ブラウザが自動で開きます**

### 方法2: コマンドラインを使う

```bash
npm start
```

---

## 使い方

### 1. 検索キーワードを入力

検索キーワード欄に **場所 + 検索ワード** を入力します。

**入力例:**
- `東京都 渋谷区 ラーメン`
- `大阪府 梅田 カフェ`
- `新宿駅 居酒屋`
- `横浜市 イタリアン`

### 2. 絞り込み条件を設定（任意）

| 項目 | 説明 | 例 |
|------|------|-----|
| 評価下限/上限 | 評価の範囲を指定（0〜5） | 3.0〜4.5 |
| レビュー下限/上限 | レビュー数の範囲を指定 | 10〜500 |
| 予算下限/上限 | 1000円単位で価格帯を指定 | 1000〜3000 |
| 住所 | 住所に含まれる文字で絞り込み | 渋谷、港区 |
| カテゴリ | カテゴリ名で絞り込み | カフェ、居酒屋 |
| 営業曜日 | 営業している曜日で絞り込み（複数選択可） | 土、日 |
| 営業時間 | 指定した時刻に営業中の店舗を抽出 | 22:00 |

### 3. 検索開始

**「検索開始」ボタン**をクリックするとスクレイピングが開始されます。

進捗状況が表示され、「絞り込み中 X件目 / Y件」のように処理状況を確認できます。

### 4. 結果の確認・ダウンロード

- 結果がテーブルに表示されます
- 「MAP」列のリンクから各店舗のGoogle Mapsを開けます
- 「CSVダウンロード」ボタンでファイルを保存できます

---

## 出力されるCSVの項目

| カラム名 | 内容 |
|---------|------|
| 店名 | 店舗の名前 |
| カテゴリ | 業種（カフェ、ラーメン店など） |
| 評価 | Google Mapsの評価（1.0〜5.0） |
| 評価件数 | レビューの件数 |
| 予算 | 価格帯（￥1,000〜2,000 など） |
| 営業時間 | 曜日ごとの営業時間 |
| 住所 | 店舗の住所 |
| 口コミ | ユーザーの口コミ（★評価付き） |
| URL | Google Mapsのリンク |

---

## フィルタリングの仕組み

### 事前フィルタリング（高速）
以下の条件は検索結果リストの段階でフィルタリングされるため、処理が高速です：
- 評価
- レビュー数
- カテゴリ
- 予算

### 詳細フィルタリング
以下の条件は各店舗の詳細ページを取得した後にフィルタリングされます：
- 住所（含む）
- 営業曜日
- 営業時間

---

## コマンドライン版（CLI）

GUIを使わずコマンドラインから実行することもできます。

```bash
node index.js --address "渋谷駅" --keyword "カフェ" --rating 4.0 --count 100 --output results.csv
```

### オプション

| オプション | 説明 | デフォルト |
|-----------|------|-----------|
| `-a, --address` | 検索の中心地点（必須） | - |
| `-k, --keyword` | 検索キーワード（必須） | - |
| `-r, --rating` | 最低評価 | 0 |
| `--rating-max` | 最高評価 | - |
| `-c, --count` | 最低レビュー数 | 0 |
| `--count-max` | 最高レビュー数 | - |
| `-o, --output` | 出力ファイル名 | output.csv |

### 例

```bash
# 新宿駅周辺のラーメン屋（評価4.0以上）
node index.js -a "新宿駅" -k "ラーメン" -r 4.0 -o ramen.csv

# 銀座の寿司屋（レビュー50件以上）
node index.js -a "銀座" -k "寿司" -c 50 -o sushi.csv
```

---

## ポータブル版

Node.jsがインストールされていないPCでも使用できるポータブル版を作成できます。

1. **`ポータブル版作成.bat`** をダブルクリック
2. 「ポータブル版」フォルダに一式が作成されます
3. フォルダごとZIP圧縮して配布可能（約200MB）

---

## トラブルシューティング

### 「結果が見つかりませんでした」と表示される

- 絞り込み条件を緩くしてみてください
- キーワードを変えてみてください（例: 「喫茶店」→「カフェ」）

### 検索に時間がかかる

- 結果が多いほど時間がかかります
- 事前フィルター（評価、カテゴリ、予算）を活用すると効率的です

### エラーが発生する

1. `セットアップ.bat` を再実行してみてください
2. Node.jsが正しくインストールされているか確認してください

### CSVが文字化けする

Excelで開く場合は、「データ」→「テキストファイルから」でUTF-8を指定してインポートしてください。

---

## 注意事項

- このツールはGoogle Mapsのスクレイピングを行います
- 過度な使用はIPブロックの原因になる可能性があります
- 個人利用の範囲でご使用ください

---

## 免責事項

本ツールは「現状のまま」で提供されます。本ツールの使用により生じたいかなる損害（データの損失、サービスの中断、IPブロック、アカウント制限等を含むがこれらに限定されない）についても、開発者は一切の責任を負いません。本ツールの使用は利用者自身の責任において行ってください。
