# Google Map Exporter 使い方ガイド

Google Maps から店舗情報を検索し、CSVファイルに出力するツールです。

---

## 動作環境

- **Windows 10/11**
- **Node.js 18以上** （https://nodejs.org/ からダウンロード）

---

## 初期セットアップ（初回のみ）

### 方法1: バッチファイルを使う（推奨）

1. **`セットアップ.bat`** をダブルクリック
2. セットアップが完了するまで待つ（数分かかります）
3. 「セットアップ完了！」と表示されたら完了

### 方法2: コマンドラインを使う

```bash
npm install
```

> 自動的にChromiumブラウザもインストールされます

---

## 起動方法

### 方法1: バッチファイルを使う（推奨）

1. **`起動.bat`** をダブルクリック
2. **ブラウザが自動で開きます**

### 方法2: コマンドラインを使う

```bash
npm start
```

---

## 使い方

### 1. 検索条件を入力

| 項目 | 説明 | 例 |
|------|------|-----|
| 都道府県 | ドロップダウンから選択（任意） | 東京都 |
| 市区町村・駅名 | 検索エリアを指定（任意） | 渋谷区、新宿駅 |
| 業種・キーワード | 検索する店舗の種類（**必須**） | カフェ、ラーメン、居酒屋 |

### 2. 絞り込み条件を設定（任意）

| 項目 | 説明 | 例 |
|------|------|-----|
| 評価（以上） | この評価以上の店舗のみ（0〜5） | 3.5 |
| レビュー数（以上） | このレビュー数以上の店舗のみ | 50 |
| 予算（範囲指定） | 1000円単位で下限〜上限を指定 | 1000〜3000 |
| 住所（含む） | 住所に含まれる文字で絞り込み | 渋谷区、港区 |
| カテゴリ（含む） | カテゴリ名で絞り込み（ドロップダウンから選択可） | カフェ、居酒屋 |
| 営業曜日 | 営業している曜日で絞り込み（複数選択可） | 土、日 |
| 営業時間 | 指定した時刻に営業中の店舗を抽出 | 22:00 |

### 3. 検索開始

**「検索開始」ボタン**をクリックするとスクレイピングが開始されます。

> **注意**: Enterキーでは送信されません。必ずボタンをクリックしてください。

### 4. 結果のダウンロード

検索完了後、「CSVダウンロード」ボタンでファイルを保存できます。

---

## 出力されるCSVの項目

| カラム名 | 内容 |
|---------|------|
| 店名 | 店舗の名前 |
| カテゴリ | 業種（カフェ、ラーメン店など） |
| 評価 | Google Mapsの評価（1.0〜5.0） |
| 評価件数 | レビューの件数 |
| 予算 | 価格帯（￥1,000〜2,000 など） |
| 営業時間 | 曜日ごとの営業時間 |
| 住所 | 店舗の住所 |
| 口コミ | ユーザーの口コミ（★評価付き） |
| URL | Google Mapsのリンク |

---

## フィルタリングの仕組み

### 事前フィルタリング（高速）
以下の条件は検索結果リストの段階でフィルタリングされるため、処理が高速です：
- 評価
- レビュー数
- カテゴリ
- 予算

### 詳細フィルタリング
以下の条件は各店舗の詳細ページを取得した後にフィルタリングされます：
- 住所（含む）
- 営業曜日
- 営業時間

---

## コマンドライン版（CLI）

GUIを使わずコマンドラインから実行することもできます。

```bash
node index.js --address "渋谷駅" --keyword "カフェ" --rating 4.0 --count 100 --output results.csv --headless
```

### オプション

| オプション | 説明 | デフォルト |
|-----------|------|-----------|
| `-a, --address` | 検索の中心地点（必須） | - |
| `-k, --keyword` | 検索キーワード（必須） | - |
| `-r, --rating` | 最低評価 | 0 |
| `-c, --count` | 最低レビュー数 | 0 |
| `-o, --output` | 出力ファイル名 | output.csv |
| `--headless` | ヘッドレスモード | false |

### 例

```bash
# 新宿駅周辺のラーメン屋（評価4.0以上）
node index.js -a "新宿駅" -k "ラーメン" -r 4.0 -o ramen.csv --headless

# 銀座の寿司屋（レビュー50件以上）
node index.js -a "銀座" -k "寿司" -c 50 -o sushi.csv --headless
```

---

## ポータブル版

Node.jsがインストールされていないPCでも使用できるポータブル版を作成できます。

1. **`ポータブル版作成.bat`** をダブルクリック
2. 「ポータブル版」フォルダに一式が作成されます
3. フォルダごとZIP圧縮して配布可能（約200MB）

---

## トラブルシューティング

### 「結果が見つかりませんでした」と表示される

- 評価やレビュー数のフィルターを緩くしてみてください
- キーワードを変えてみてください（例: 「喫茶店」→「カフェ」）

### 検索に時間がかかる

- 結果が多いほど時間がかかります
- ヘッドレスモードONで少し速くなります
- 事前フィルター（評価、カテゴリ、予算）を活用すると効率的です

### エラーが発生する

1. `セットアップ.bat` を再実行してみてください
2. Node.jsが正しくインストールされているか確認してください

### CSVが文字化けする

Excelで開く場合は、「データ」→「テキストファイルから」でUTF-8を指定してインポートしてください。

---

## 注意事項

- このツールはGoogle Mapsのスクレイピングを行います
- 過度な使用はIPブロックの原因になる可能性があります
- 個人利用の範囲でご使用ください

---

## ファイル構成

```
GoogleMapExporter/
├── セットアップ.bat       # 初期セットアップ用
├── 起動.bat              # サーバー起動用
├── ポータブル版作成.bat   # ポータブル版作成用
├── server.js             # Webサーバー
├── scraper.js            # スクレイピング処理
├── csvExporter.js        # CSV出力処理
├── index.js              # CLI版メイン
├── public/               # Web UI
│   ├── index.html
│   ├── style.css
│   └── app.js
├── README.md             # 概要説明
└── 使い方.md             # このファイル
```
