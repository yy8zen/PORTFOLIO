# Google Map Exporter

Google Mapsから店舗情報を取得してCSVファイルに出力するツールです。

## 機能

- 指定した住所（都道府県・市区町村）とキーワードで店舗を検索
- 豊富なフィルタリング機能：
  - 評価（数値指定）
  - レビュー数（数値指定）
  - カテゴリ（部分一致）
  - 予算（範囲指定）
  - 営業曜日（複数選択可）
  - 営業時間（指定時刻に営業中の店舗を抽出）
- 以下の情報をCSVで出力：
  - 店名
  - カテゴリ
  - 評価（★）
  - 評価件数
  - 予算
  - 営業時間
  - 住所
  - 口コミ（★評価付き）
  - Google MapのURL

## クイックスタート

### 方法1: バッチファイルを使う（推奨）

1. **`セットアップ.bat`** をダブルクリック（初回のみ）
2. **`起動.bat`** をダブルクリック
3. ブラウザが自動で開きます

### 方法2: コマンドラインを使う

```bash
# インストール
npm install

# 起動
npm start
```

## 使用方法

### Webインターフェース

1. **検索条件**を入力
   - 都道府県（ドロップダウンから選択）
   - 市区町村・駅名（任意）
   - 業種・キーワード（必須）例: ラーメン、カフェ、居酒屋

2. **絞り込み条件**を設定（任意）
   - 評価（以上）: 数値で指定（例: 3.5）
   - レビュー数（以上）: 数値で指定（例: 50）
   - 予算（範囲指定）: 下限〜上限を1000円単位で指定
   - 住所（含む）: 特定の地区名など
   - カテゴリ（含む）: ドロップダウンから選択または入力
   - 営業曜日: チェックボックスで複数選択可
   - 営業時間: 指定した時刻に営業中の店舗を抽出

3. **「検索開始」ボタン**をクリック（Enterキーでは送信されません）

4. 完了後、**CSVファイルをダウンロード**

### コマンドライン版（CLI）

```bash
node index.js --address "新宿駅" --keyword "ラーメン" --rating 4.0 --count 50 --output result.csv --headless
```

#### オプション

| オプション | 説明 | デフォルト |
|-----------|------|-----------|
| `-a, --address` | 検索の中心地点（必須） | - |
| `-k, --keyword` | 検索キーワード（必須） | - |
| `-r, --rating` | 最低評価 | 0 |
| `-c, --count` | 最低レビュー数 | 0 |
| `-o, --output` | 出力ファイル名 | output.csv |
| `--headless` | ヘッドレスモード | false |

## 出力CSV項目

| カラム名 | 内容 |
|---------|------|
| 店名 | 店舗の名前 |
| カテゴリ | 業種（カフェ、ラーメンなど） |
| 評価 | Google Mapsの評価（1.0〜5.0） |
| 評価件数 | レビューの件数 |
| 予算 | 価格帯（￥1,000〜2,000 など） |
| 営業時間 | 曜日ごとの営業時間 |
| 住所 | 店舗の住所 |
| 口コミ | ユーザーの口コミ（★評価付き） |
| URL | Google Mapsのリンク |

## ポータブル版

Node.jsがインストールされていない環境でも使用できるポータブル版を作成できます。

1. **`ポータブル版作成.bat`** をダブルクリック
2. 「ポータブル版」フォルダが作成されます
3. フォルダごとZIP圧縮して配布可能

## プロジェクト構造

```
GoogleMapExporter/
├── セットアップ.bat       # 初期セットアップ用
├── 起動.bat              # サーバー起動用
├── ポータブル版作成.bat   # ポータブル版作成用
├── server.js             # Webサーバー
├── scraper.js            # スクレイピング処理
├── csvExporter.js        # CSV出力処理
├── index.js              # CLI版メイン
├── public/               # Web UI
│   ├── index.html
│   ├── style.css
│   └── app.js
├── README.md             # このファイル
├── 使い方.md             # 詳細な使い方ガイド
└── CLAUDE.md             # 開発者向けドキュメント
```

## 技術スタック

- **Node.js**: JavaScriptランタイム
- **Playwright**: ブラウザ自動化
- **Express.js**: Webサーバー
- **Socket.IO**: リアルタイム通信
- **csv-writer**: CSV出力

## 注意事項

- このツールはWebスクレイピングを使用しています
- Google MapsのUIは頻繁に変更されるため、動作しなくなる可能性があります
- 過度な使用はIPブロックやCAPTCHA認証を引き起こす可能性があります
- **個人的な利用にとどめてください**

## トラブルシューティング

### 検索結果が0件
- 評価やレビュー数のフィルターを緩くしてみてください
- キーワードを変えてみてください

### スクレイピングが途中で止まる
- Google MapsのUIが変更された可能性があります
- ヘッドレスモードをOFFにしてブラウザの動作を確認してください

### CSVが文字化けする
Excelで開く場合は、「データ」→「テキストファイルから」でUTF-8を指定してインポートしてください。

## 免責事項

このツールは教育目的で作成されました。使用による一切の責任は使用者が負うものとします。Google Mapsの利用規約を遵守してください。
